"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[334],{64902:function(t,e,r){r.d(e,{AN:function(){return f},FB:function(){return d},Hf:function(){return h},Pf:function(){return y},Xq:function(){return c},ZQ:function(){return p},_W:function(){return _},bw:function(){return v},dv:function(){return u},h2:function(){return l},nS:function(){return m}});var i=r(57460),a=r(6692),n=r(17930),o=r(38398),s=t=>{var{urlParams:e={},queryParams:r={}}=t,a="/cart/".concat(e.isPrimary?n.Yl:n.d7),s=(0,i._)({},r);return{url:a,defaultParams:s,formattedUrl:(0,o.format)({pathname:a,query:s})}},u=function(){var{urlParams:t={},queryParams:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=s({urlParams:t,queryParams:e}),n=(0,i._)({},r.defaultParams);return(0,a._)((0,i._)({},r),{defaultParams:n,formattedUrl:(0,o.format)({pathname:r.url,query:n})})},l=s,c=s,d=t=>{var{urlParams:e={},queryParams:r={}}=t,a="/cart/".concat(e.fromCartType,"/to/").concat(e.toCartType),n=(0,i._)({},r);return{url:a,defaultParams:n,formattedUrl:(0,o.format)({pathname:a,query:n})}},v=t=>{var{urlParams:e={}}=t,r="/organization/".concat(e.organizationId,"/invitations/").concat(e.status);return{url:r,formattedUrl:(0,o.format)({pathname:r})}},m=t=>{var{urlParams:e={}}=t,r="/account/user/".concat(e.id,"/settings");return{url:r,formattedUrl:(0,o.format)({pathname:r})}},p=t=>{var{urlParams:e={}}=t,r="/account/user/".concat(e.id,"/settings");return{url:r,formattedUrl:(0,o.format)({pathname:r})}},f=t=>{var{urlParams:e={}}=t,r="/organization/".concat(e.organizationId,"/invitations/").concat(e.invitationId);return{url:r,formattedUrl:(0,o.format)({pathname:r})}},h=t=>{var{urlParams:e={}}=t,r="/organization/".concat(e.organizationId,"/invitations");return{url:r,formattedUrl:(0,o.format)({pathname:r})}},_=t=>{var{urlParams:e={}}=t,r="/organization/users/".concat(e.id);return{url:r,formattedUrl:(0,o.format)({pathname:r})}},y=function(){var{queryParams:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e="/cart/".concat(n.Yl,"/quote"),r=(0,a._)((0,i._)({},t),{exclude_comps:1,expand:"agreements"});return{url:e,defaultParams:r,formattedUrl:(0,o.format)({pathname:e,query:r})}}},27820:function(t,e,r){r.d(e,{n:function(){return l}});var i=r(94095),a=r(82239),n=r(64617),o=r(75371),s=r(38409),u=t=>{var{acc:e,totalCostOfItems:r,amountRemaining:a,totalAmount:n,bypassLowBalance:o=!1}=t;return o||(r>a&&(e.hasInsufficientSubscriptionCredits=!0,e.hasLowDebitableBalance=!1,e.insufficientAmount=r-a),!e.hasInsufficientSubscriptionCredits&&a<=n*i.cG&&(e.hasLowDebitableBalance=!0)),e},l=t=>{var{items:e,subscriptions:r,subscription:l,hasWrapperSubscription:c=!0}=t;if(e&&e.length){var d={hasInsufficientSubscriptionCredits:!1,hasLowDebitableBalance:!1,insufficientAmount:0,total:0,totalCreditAmount:0,amountType:i.Zm};return e.reduce((t,e)=>{var d,{licenseId:v,price:m}=e,p=(0,n.q)({assets:[e]}),f=l||(0,s.$)({subscriptions:null===(d=(0,o.A)({assetType:p,subscriptions:r}))||void 0===d?void 0:d.subscriptions,licenseName:v,assetType:p})||{},{totalAmount:h,amountRemaining:_,amountType:y,amount:g}=(0,a.Vp)(f);t.amountType=y;var b=parseFloat(m),w=parseFloat(t.total)+b;if(t.total+=b,y===i.vh){var I=parseFloat(g),C=parseFloat(t.totalCreditAmount)+I;return t.totalCreditAmount+=I,u({acc:t,totalCostOfItems:C,amountRemaining:_,totalAmount:h,bypassLowBalance:!c})}return u({acc:t,totalCostOfItems:w,amountRemaining:_,totalAmount:h,bypassLowBalance:!c})},d)}var v=r||{},m=Object.keys(v).find(t=>Array.isArray(v[t])&&v[t].length),p=m&&(0,a.bC)({subscriptions:v[m]||[]})[0]||{},{totalAmount:f,amountRemaining:h,amountType:_}=(0,a.Vp)(p);return{amountType:_,hasInsufficientSubscriptionCredits:!1,hasLowDebitableBalance:h<=f*i.cG,insufficientAmount:null}}},64744:function(t,e,r){r.d(e,{k:function(){return s}});var i=r(94095),a=r(82239),n=r(26844),o=r(27820),s=t=>{var e,{items:r,isLoading:s,subscription:u,subscriptions:l,userCapabilities:c}=t;return s?{}:(u&&(e=u.creditType),l&&l.length>0&&(e=l[0].creditType),(0,a.Kc)({userCapabilities:c})?(0,o.n)({items:r,subscription:u,subscriptions:l,hasWrapperSubscription:(0,a.zF)({userCapabilities:c})}):{amountType:e||i.Zm,hasLowDebitableBalance:!1,hasInsufficientSubscriptionCredits:u&&0===(0,n.I)({subscription:u}),insufficientAmount:null})}},32332:function(t,e,r){r.d(e,{U:function(){return o}});var i=r(94095),a=r(72726),n=r(46743),o=t=>{var{uniqueSubscription:e}=t;if(!e)return{};var{priceAsAbsolute:r,creditCurrency:o,product:s}=e,u=(0,n.q)({subscription:e}),l=null!=o?o:null==s?void 0:s.currency;if(!r){var{creditPrice:c,creditType:d=i.Zm}=e;return{price:"".concat((0,a.lO)({price:c,isUnlimited:u})),priceType:d,currency:l}}var{price:v,priceType:m}=r;return{price:"".concat((0,a.lO)({price:v,isUnlimited:u})),priceType:m,currency:l}}},19362:function(t,e,r){r.d(e,{K:function(){return c}});var i=r(57460),a=r(6692),n=r(97956),o=r(20463),s=r(62130),u=r(63339),l=r(2784),c=()=>{var{analytics:t}=(0,u.yh)(),{getSearchContext:e}=(0,s.Y)(),r=(0,l.useCallback)(e=>{var{cartId:r,items:i}=e,a=(i||[]).map((t,e)=>(0,o.zm)({asset:t,cartId:r,index:e})),n=a.reduce((t,e)=>({totalPrice:t.totalPrice+Number(e.price),toBeBilled:t.toBeBilled+1}),{totalPrice:0,toBeBilled:0});t.cartViewed({products:a,cartId:r,cartTotal:Math.round(100*n.totalPrice)/100,numItemsBilledToCard:n.toBeBilled,shouldCheckout:n.totalPrice>0,shouldDownload:a.length>0&&0===n.totalPrice})},[t]);return{productAddedAnalyticsEvent:(0,l.useCallback)(r=>{var{cart:i,eventLabel:a,gridItems:n,items:s,licenseId:u,licensePrice:l,listId:c,pageSection:d}=r;t.productAdded({products:s.map(t=>(0,o.bR)({asset:t,cartData:i,getSearchContext:e,gridItems:n,licenseId:u,licensePrice:l,pageSection:d})),eventLabel:a,list_id:null!=c?c:""})},[t,e]),productRemovedAnalyticsEvent:(0,l.useCallback)(r=>{var{cart:s,eventLabel:u,gridItems:l,items:c,listId:d,matchingCartItem:v,pageSection:m}=r;if(v){var[p]=c;t.productRemoved((0,a._)((0,i._)({},(0,o.bR)({asset:p,cartData:s,getSearchContext:e,gridItems:l,pageSection:m})),{price:v.price===n.q9?0:Number(v.price),variant:v.licenseId,eventLabel:u,list_id:null!=d?d:""}))}else t.productRemoved({products:c.map(t=>(0,o.bR)({asset:t,cartData:s,getSearchContext:e,gridItems:l,pageSection:m})),eventLabel:u,list_id:null!=d?d:""})},[t,e]),cartViewedAnalyticsEvent:r}}},87384:function(t,e,r){r.d(e,{y:function(){return _}});var i,a=r(81862),n=r(57460),o=r(6692),s=r(39494),u=r(52104),l=r(55728),c=r(1880),d=r(52206),v=r(34944),m=r(38005),p=(i=(0,a._)(function*(t){var{items:e,trackingId:r}=t;0!==e.length&&(yield(0,m.t)("/message-gateway/ip-review",(0,o._)((0,n._)({method:"POST",requireAuth:!0},(0,v.S)({trackingId:r})),{body:{media:e.map(t=>({mediaId:t}))}})))}),function(t){return i.apply(this,arguments)}),f=r(2784),h=r(3255),_=function(){var{trackingId:t=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,d.H)("/"),{isBrandEnterprise:r}=(0,c.D)(),{mutate:i}=(0,h.kY)();return{queueIpReview:(0,f.useCallback)(c=>{if(r){var d,v=c.reduce((t,e)=>(0,u.k7)(e)?[...t,String(e.id)]:t,[]);v.length&&(0,l.iP)(e,v).then((d=(0,a._)(function*(e){var r,a,u=e.reduce((t,e)=>(null==e?void 0:e.isIpReviewed)===!1&&(null==e?void 0:e.ipReviewStatus)!==s.hA?[...t,e]:t,[]);try{u.length&&(yield p({items:u.map(t=>null==t?void 0:t.classicId),trackingId:t}),u.forEach(t=>i(null==t?void 0:t.swrKey,[(0,o._)((0,n._)({},t),{isIpReviewed:!1,ipReviewStatus:s.hA})],{revalidate:!1})))}catch(e){null===(a=window.NREUM)||void 0===a||null===(r=a.noticeError)||void 0===r||r.call(a,e,{message:"Error adding assets to queue for IP review: ".concat(u.map(t=>null==t?void 0:t.classicId).join(", "),"\ntrackingId: ").concat(t)})}}),function(t){return d.apply(this,arguments)}))}},[e,r,t,i])}}},334:function(t,e,r){r.d(e,{D9:function(){return M},GH:function(){return Z},Z4:function(){return X},gV:function(){return K},kC:function(){return O}});var i=r(81862),a=r(57460),n=r(6692),o=r(2281),s=r(64902),u=r(94346),l=r(72212),c=r(63775),d=r(97956),v=r(17930),m=r(34129),p=r(6600),f=r(94095),h=r(20463),_=r(62463),y=r(38607),g=r(72726),b=r(87459),w=r(10546),I=r(38409),C=r(32332),T=r(25323),k=r(46743),P=r(64744),A=r(82239),U=r(62130),B=r(19362),S=r(87384),R=r(1369),q=r(46572),z=r(66487),D=r(5632),E=r(2784),x=r(3255),F=r(88759),L="Size limit warning",j=t=>{var e,{item:r,subscriptions:i}=t,{itemType:a,metadata:n}=r,o=(0,g.Qo)({asset:r}),s=null==n?void 0:null===(e=n.cart)||void 0===e?void 0:e.licenseId,{allSubscriptions:u}=i;switch(a){case d.pX:return(0,w.I)({licenseName:s,subscriptions:u});case d.j0:case d.tn:case d.k4:default:return(0,I.$)({licenseName:s,subscriptions:u,assetType:a,contentTier:o})}},N=t=>{var e,r,{item:i}=t;return(null===(e=i.largeThumb)||void 0===e?void 0:e.url)||(null===(r=i.preview)||void 0===r?void 0:r.url)||i.preview||i.thumb||""},V=t=>{var e,{asset:r}=t;return r.itemType===d.k4&&!r.sizes&&!(null===(e=r.metadata)||void 0===e?void 0:e.cart.sizes)},Y=t=>{var e,r,{item:i}=t,o=(0,g.EK)(i);if(i.itemType===d.w5){var s,u,l,v,m,p,f,h,_,y,w,I=null==i?void 0:null===(h=i.product)||void 0===h?void 0:null===(f=h.productPreviews[0])||void 0===f?void 0:null===(p=f.previewThumbnailImages)||void 0===p?void 0:p.find(t=>{var{resolution:e}=t;return"res600x600"===e}),C={[c.RA]:{height:600,width:600,src:"https://".concat(null==I?void 0:null===(_=I.assetFile)||void 0===_?void 0:_.s3Path)}};return{[c.RA]:{height:600,width:600,src:(0,b.VC)((0,n._)((0,a._)({},i),{angle:null==i?void 0:null===(w=i.metadata)||void 0===w?void 0:null===(y=w.cart)||void 0===y?void 0:y.angle,displays:C}))}}}return o?{[c.bm]:{height:i.height||(null===(e=i.preview)||void 0===e?void 0:e.height),width:i.width||(null===(r=i.preview)||void 0===r?void 0:r.width),src:i.preview||i.thumb}}:{[c.RA]:{height:(null===(s=i.largeThumb)||void 0===s?void 0:s.height)||(null===(u=i.preview)||void 0===u?void 0:u.height),width:(null===(l=i.largeThumb)||void 0===l?void 0:l.width)||(null===(v=i.preview)||void 0===v?void 0:v.width),src:null===(m=i.preview)||void 0===m?void 0:m.url}}},M=t=>{var{cartItems:e=[],subscriptions:r}=t;return e.filter(t=>[d.k4,d.w5,d.pX,d.j0,d.tn,d.gP,d.cF].includes(t.itemType)).map(t=>{var e,i,o,s,u,l,v,m,_,y,g,b,w,I=j({item:t,subscriptions:r}),P=Y({item:t}),A=N({item:t}).replace("-150nw","-260nw"),{price:U=0,priceType:B=f.Zm}=(0,C.U)({uniqueSubscription:I}),S=A||(null==P?void 0:null===(e=P[c.RA])||void 0===e?void 0:e.src),R=null===(i=t.assets)||void 0===i?void 0:i.find(t=>{var{assetClass:e}=t;return e===p.TT}),q=[d.w5,d.k4].includes(t.itemType)&&!t.src,z=null===(o=t.meta)||void 0===o?void 0:o.search_context;return(null===(u=t.metadata)||void 0===u?void 0:null===(s=u.cart)||void 0===s?void 0:s.searchContext)&&(z=(0,h.Be)({trackingId:null===(y=t.metadata)||void 0===y?void 0:null===(_=y.cart)||void 0===_?void 0:null===(m=_.searchContext)||void 0===m?void 0:m.searchTrackingId,searchTerm:null===(w=t.metadata)||void 0===w?void 0:null===(b=w.cart)||void 0===b?void 0:null===(g=b.searchContext)||void 0===g?void 0:g.searchTerm})),(0,a._)((0,n._)((0,a._)((0,n._)((0,a._)({},t),{id:t.itemId}),[d.k4,d.w5,d.gP,d.cF].some(e=>e===t.itemType)&&{image:{id:t.itemId,categories:t.categories,description:t.description||t.subhead||"",url:S,isEditorial:!!t.isEditorial,isPremium:!!t.isPremium,displays:P,permalink:t.permalink,isIllustration:t.isIllustration,isVector:t.isVector}}),{type:t.itemType,isFootageSelect:t.footageSelect,price:U,priceType:B,waveformPng:t.waveformPng||(null==R?void 0:R.externalUrl),currency:(null==I?void 0:I.creditCurrency)||"",licenseId:(null===(v=t.metadata)||void 0===v?void 0:null===(l=v.cart)||void 0===l?void 0:l.licenseId)||"",subscriptionId:(null==I?void 0:I.id)||"-",hasCreditsRemaining:(0,T.r)({subscription:I}),isPixelSquid:t.itemType===d.w5,isUnavailableAsset:V({asset:t}),isUnlimited:(0,k.q)({subscription:I}),isUnavailableSubscription:!I,meta:(0,a._)({},z?{search_context:z}:{})}),q&&{src:S})})},O=t=>{var{isPrimary:e}=t;return(0,s.dv)({urlParams:{isPrimary:e}}).formattedUrl},Z=t=>{var{isPrimary:e}=t,r=(0,F.B)(),{data:i}=(0,R.av)();return(0,x.ZP)(r&&i?O({isPrimary:e}):null,t=>z.jm.get(t).then(t=>{var{data:e}=t;return e&&(0,n._)((0,a._)({},e),{items:M({cartItems:e.items,subscriptions:i})})}))},K=()=>{var t,e,r,o,c,p,{mutate:f}=(0,x.kY)(),[h,g]=(0,E.useState)({status:"",error:void 0}),[b,w]=(0,E.useState)(!1),I=(0,E.useRef)(!1),{productAddedAnalyticsEvent:C,cartViewedAnalyticsEvent:T,productRemovedAnalyticsEvent:k}=(0,B.K)(),{getSearchContext:P}=(0,U.Y)(),A=(0,D.useRouter)(),{queueIpReview:R}=(0,S.y)({trackingId:null===(p=P())||void 0===p?void 0:p.search_tracking_id}),q=(0,E.useCallback)(t=>{void 0===(null==t?void 0:t.cartId)||I.current||(I.current=!0,T(t))},[I,T]),F=(0,E.useCallback)(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.filter(t=>{var{id:r}=t;return -1===e.findIndex(t=>{var{id:e}=t;return r===e})})},[]),j=(0,E.useCallback)(t=>{var{cartItems:e=[],itemsToAdd:r=[]}=t,i=[...e];return r.forEach(t=>{var e=(0,_.rw)({asset:t}),r=i.findIndex(r=>{var{id:i,type:a}=r;return i===t.id&&a===e});r>-1?i[r]=(0,a._)({},t):i.unshift((0,n._)((0,a._)({},t),{addedTime:new Date}))}),i},[]),N=(0,E.useCallback)((t=(0,i._)(function*(t){var e,{items:r,licenseId:n,licenseAsJpeg:o}=t;return Promise.all(null==r?void 0:r.map((e=(0,i._)(function*(t){var e=(0,_.rw)({asset:t}),r=n||t.licenseId,i=o||t.licenseAsJpeg,s=yield(0,y.Oo)({asset:t,licenseName:r});return{item_id:t.id,item_type:e,metadata:{cart:(0,a._)({license_id:r,license_as_jpeg:i,subscription_id:t.subscriptionId,size:s.content_size,format:s.content_format,sizes:(0,y.rB)({asset:t}),search_context:P(t),source:[d.gP,d.cF].some(t=>t===e)?m._e:""},e===d.w5&&{angle:s.angle})}}}),function(t){return e.apply(this,arguments)})))}),function(e){return t.apply(this,arguments)}),[P]),V=(0,E.useCallback)((e=(0,i._)(function*(t){var{cart:e,eventLabel:r,gridItems:i,isPrimary:o=!0,itemsToAdd:c,licenseId:d,formatType:m,licensePrice:p,mutateCart:h,withOptimisticUpdate:_=!0,pageSection:y,listId:b}=t;try{var I=c.map(t=>(0,n._)((0,a._)({},t),{meta:(0,a._)({search_context:P(t)},t.meta)}));g({status:"",error:void 0}),w(!1);var T=j({cartItems:e.items,itemsToAdd:I});if(T.length>v.fv){g({status:u.cM}),w(!0);return}_&&h(t=>(0,n._)((0,a._)({},t),{items:T}),!1);var A=(0,s.Xq)({urlParams:{isPrimary:o}}).formattedUrl,U=yield N({items:I,licenseId:d,licenseAsJpeg:m===l._3});yield z.jm.post(A,U),g({status:u.MR}),R(c),o&&I.forEach(t=>{var a=e.items.find(e=>{var{id:r}=e;return r===t.id});a&&d!==a.licenseId&&k({cart:e,eventLabel:r,gridItems:i,items:[t],matchingCartItem:a,pageSection:y}),C({cart:e,eventLabel:r,gridItems:i,items:[t],licenseId:d,licensePrice:p,pageSection:y,listId:b})})}catch(t){g({status:u.cM,error:t})}finally{yield f(O({isPrimary:o}))}}),function(t){return e.apply(this,arguments)}),[j,N,P,C,k,f,R]);return{triggerCartViewedEvent:q,addCartItems:V,removeCartItems:(0,E.useCallback)((r=(0,i._)(function*(t){var{cartData:e,eventLabel:r,gridItems:i,isPrimary:o=!0,itemsToRemove:u=[],mutateCart:l,pageSection:c,routePathProps:d,withOptimisticUpdate:v=!0,mutateCallback:m}=t;try{v&&l(t=>(0,n._)((0,a._)({},t),{items:F(t.items,u)}),!1);var p=(0,s.h2)({urlParams:{isPrimary:o}}).formattedUrl;yield z.jm.delete(p,{data:u.map(t=>({item_id:t.id,item_type:(0,_.rw)({asset:t})}))}),o&&k({cart:e,eventLabel:r,gridItems:i,items:u,pageSection:c}),d&&A.push(...d)}catch(t){}finally{m?m({isPrimary:o}):yield f(O({isPrimary:o}))}}),function(t){return r.apply(this,arguments)}),[F,k,A,f]),moveToSaveForLater:(0,E.useCallback)((o=(0,i._)(function*(t){var{eventLabel:e,itemsToMove:r,pageSection:i,primaryCart:o,savedForLaterCart:l,mutatePrimaryCart:c,mutateSavedForLaterCart:d}=t;g({status:"",error:void 0}),w(!1);var m=j({cartItems:l.items,itemsToAdd:r});if(m.length>v.fv)throw g({status:u.cM}),w(!0),Error(L);c(t=>(0,n._)((0,a._)({},t),{items:F(t.items,r)}),!1),d(t=>(0,n._)((0,a._)({},t),{items:m}),!1);var p=(0,s.FB)({urlParams:{fromCartType:v.Yl,toCartType:v.d7}}).formattedUrl,f=yield N({items:r});yield z.jm.post(p,f),k({cart:o,eventLabel:e,items:r,pageSection:i})}),function(t){return o.apply(this,arguments)}),[j,N,k,F]),moveToPrimary:(0,E.useCallback)((c=(0,i._)(function*(t){var{itemsToMove:e,primaryCart:r,mutatePrimaryCart:i,mutateSavedForLaterCart:o}=t;g({status:"",error:void 0}),w(!1);var l=j({cartItems:r.items,itemsToAdd:e});if(l.length>v.fv)throw g({status:u.cM}),w(!0),Error(L);o(t=>(0,n._)((0,a._)({},t),{items:F(t.items,e)}),!1),i(t=>(0,n._)((0,a._)({},t),{items:l}),!1);var c=(0,s.FB)({urlParams:{fromCartType:v.d7,toCartType:v.Yl}}).formattedUrl,d=yield N({items:e});yield z.jm.post(c,d),C({cart:r,items:e})}),function(t){return c.apply(this,arguments)}),[j,N,C,F]),addToCartStatus:h,setAddToCartStatus:g,isSizeLimitWarning:b}},X=t=>{var{cartItems:e}=t,{data:r}=(0,R.av)(),i=(0,q.U)(),{isLoading:a}=i,n=(0,o._)(i,["isLoading"]),s=(t=>{var{items:e}=t;return null==e?void 0:e.some(t=>{var{hasCreditsRemaining:e}=t;return!e})})({items:e}),{amountType:u,hasInsufficientSubscriptionCredits:l,insufficientAmount:c,hasLowDebitableBalance:d}=(0,P.k)({items:e,isLoading:!r||a,subscriptions:r,userCapabilities:n});return{amountType:u,isDebitableUser:(0,A.Kc)({userCapabilities:n}),userCanViewDebitableBalance:(0,A.LQ)({userCapabilities:n}),hasInsufficientCartItemsCredits:s,hasInsufficientSubscriptionCredits:l,insufficientAmount:c,hasLowDebitableBalance:d}}}}]);
//# sourceMappingURL=334-ed5519ee806bcff9.js.map