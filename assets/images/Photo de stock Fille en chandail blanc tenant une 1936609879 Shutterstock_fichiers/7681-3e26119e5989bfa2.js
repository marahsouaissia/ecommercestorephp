"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7681],{88809:function(e,n,r){r.d(n,{K0:function(){return o},Zk:function(){return i}});var t=r(38398),i=()=>{var e="/email/ss_premier_sub_account_activation_email";return{url:e,formattedUrl:(0,t.format)({pathname:e})}},o=()=>{var e="/email/premier_cart_confirmation";return{url:e,formattedUrl:(0,t.format)({pathname:e})}}},68861:function(e,n,r){r.d(n,{C:function(){return t}});var t=/^[\w-.~!$%^&*_=+}{'?-]+@([\w-]+\.)+[\w-]{2,4}/},12139:function(e,n,r){r.d(n,{KK:function(){return p},Jj:function(){return b},GA:function(){return m},tU:function(){return v},Hg:function(){return d},c:function(){return S},P1:function(){return C},Tw:function(){return y},$6:function(){return h}});var t=r(57460),i=r(6692),o=r(97956),a=r(17930),l=["contributor_inactive","contributor_opted_out","MEDIA_NOT_AVAILABLE"],u=r(69565),c=r(91145),s=r(72726),d=e=>{var{licenseName:n,cartData:r,asset:t}=e;return n?!!(null==r?void 0:r.items.find(e=>e.id===(null==t?void 0:t.id)&&e.licenseId===n)):!!(null==r?void 0:r.items.find(e=>e.id===(null==t?void 0:t.id)))},v=e=>{var{asset:n,unavailableAssets:r}=e;return!r.find(e=>e.contentId===(0,s.OP)({asset:n})&&e.contentType===n.type)},m=function(){var{errors:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.some(e=>l.includes(e))},p=e=>{var{cachedCart:n,newItems:r}=e,o=[...(null==n?void 0:n.items)||[],...r];return(0,i._)((0,t._)({},n),{items:o,count:o.length})},_=e=>{var{item:n,licensedAssets:r}=e;return(null==r?void 0:r.find(e=>{var{contentId:r}=e;return r===String(n.id)}))?0:n.isUnlimited?.1:parseFloat(n.price)},f=e=>{var{item1:n={},item2:r={},sortOrder:t,licensedAssets:i}=e,o=_({item:n,licensedAssets:i}),a=_({item:r,licensedAssets:i});return t===u.sl?o-a:a-o},g=e=>{var{item1:n,item2:r,sortField:t="addedTime",sortOrder:i}=e;return i===u.sl?Number(new Date(r[t]))-Number(new Date(n[t])):Number(new Date(n[t]))-Number(new Date(r[t]))},h=e=>{var{primaryCart:n,sortField:r,sortOrder:t,alreadyLicensedPrimaryAssets:i}=e;return n.sort((e,n)=>r===a.TK.ADDED_TIME?g({item1:e,item2:n,sortField:r,sortOrder:t}):f({item1:e,item2:n,sortField:r,sortOrder:t,licensedAssets:i}))},y=e=>{var n,{rolodexAddress:r}=e,[t,i]=(null===(n=r.streetLines)||void 0===n?void 0:n.split("\n"))||[],{locality:o,postalCode:a,region:l,country:u,company:c}=r;return{country:u,company:c,city:o,zip:a,state:l,address1:t,address2:i}},b=e=>{var n,{billingEntity:r}=e;return(null==r?void 0:null===(n=r.rolodexAddresses)||void 0===n?void 0:n.find(e=>{var n;return"licensing"===e.addressType||(null===(n=e.usages)||void 0===n?void 0:n.includes("licensing"))}))||{}},I=e=>{var{asset:n,alreadyLicensedAssets:r}=e;return(null==n?void 0:n.price)===o.q9||(0,c.te)({alreadyLicensedAssets:r,asset:n})},w=e=>{var{acc:n,asset:r,alreadyLicensedAssets:t}=e;return I({asset:r,alreadyLicensedAssets:t})?n:n+parseFloat(null==r?void 0:r.price)},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return n?e.filter(e=>{var{isUnavailableAsset:n}=e;return!n}).reduce((e,r)=>w({acc:e,asset:r,alreadyLicensedAssets:n}),0):0},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return e.every(e=>{var{price:n}=e;return n===o.q9})?o.q9:S(e,n)}},91145:function(e,n,r){r.d(n,{Ax:function(){return y},H8:function(){return m},Hl:function(){return b},NV:function(){return v},Tp:function(){return I},aW:function(){return w},iI:function(){return f},j2:function(){return g},lW:function(){return h},te:function(){return p},uP:function(){return d}});var t=r(57460),i=r(6692),o=r(72212),a=r(97956),l=r(59100),u=r(22253),c=r(72726),s=r(62463),d=e=>{var n,r,{license:t,existingAssetsLicenses:i}=e;if(!i)return!((null==t?void 0:t.licenseName)&&u.b53.includes(null==t?void 0:t.licenseName))&&i;var o=(0,s.Fy)({asset:t.mediaItem});return!!(null==i?void 0:null===(n=i[null===(r=t.mediaItem)||void 0===r?void 0:r.id])||void 0===n?void 0:n.some(e=>e!==u._rW[o]))},v=e=>{var{subscriptions:n=[]}=e;return n.some(e=>{var{redeemableFor:n}=e;return u.SkX.some(e=>e===n)})?u.s5m:u.Hv9},m=e=>e.reduce((e,n)=>{var r=n.licenseId;return e.includes(r)||e.push(r),e},[]),p=e=>{var{alreadyLicensedAssets:n,asset:r}=e;return!!n.find(e=>{var{contentId:n,contentType:t,licenseId:i}=e,o=r.type===a.k4?a.pV:r.type;return n===r.id&&t===o&&i===r.licenseId})},_=e=>{var{licenseType:n,existingLicenses:r,asset:t,isSelect:i=!1}=e,o=["footage_".concat(n,"_sd"),"footage_".concat(n,"_hd")],a=[...o,"footage_".concat(n,"_lowres")];return(i&&o.push("footage_".concat(n,"_4k")),t.licenseId==="footage_".concat(n,"_sd"))?null==r?void 0:r.some(e=>!!o.includes(e)):t.licenseId==="footage_".concat(n,"_lowres")&&(null==r?void 0:r.some(e=>!!a.includes(e)))},f=e=>{var n,{existingLicenses:r,asset:t}=e;switch(t.type){case a.FM:case a.pX:if(u.oPg.some(e=>_({asset:t,licenseType:e,existingLicenses:r})))return!0;return!!(null==r?void 0:r.includes(t.licenseId));case a.k4:default:return!!(null==r?void 0:r.includes(null===(n=t.licenseId)||void 0===n?void 0:n.replace(/_unlimited/,"")))}},g=e=>{var{error:n={},t:r}=e,{meta:t={}}=n;if((null==t?void 0:t.exception_type)===u.JW1){var{value:i}=t.errors.slice(-1).pop(),o="comp_limit"===i.name;return r("P1M"===i.period_length?o?"ent:monthly_comp_limit_reached":"ent:monthly_licensing_limit_reached":o?"ent:daily_comp_limit_reached":"ent:daily_licensing_limit_reached")}return r("ent:license_now_error_message")},h=e=>{var{error:n={},user:r={}}=e,{detail:t,headers:i={},message:o,meta:a={},name:c,source:s={},title:d}=n,{id:v,username:m,organizationId:p}=r||{},_=null==a?void 0:a.exception_type,f=(null==s?void 0:null===(g=s.request)||void 0===g?void 0:g.id)||(null==i?void 0:i[l.cp]);switch(_){case u.JW1:var g,h,y,b=null===(y=a.errors)||void 0===y?void 0:y.map(e=>{var{value:n}=e;return null==n?void 0:n.name});h="".concat(d,": ").concat(b.join(","));break;case u.vFJ:var I,w=null===(I=a.errors)||void 0===I?void 0:I.map(e=>{var{code:n,value:r}=e;return"".concat(n,": ").concat(null==r?void 0:r.content_type," - ").concat(null==r?void 0:r.content_id," - ").concat(null==r?void 0:r.content_size)});h="".concat(d,": ").concat(w.join(","));break;default:h=[_,d,t,o,c].reduce((e,n)=>n&&!e.includes(n)?[...e,n]:e,[]).join(", ")}return{organizationId:p,userId:v,username:m,errorSummary:h,error:n,requestId:f}},y=e=>{var{organizationId:n}=e;return"organization-".concat(n)},b=e=>{var{user:n,isItemLoaded:r,labels:t}=e;return""!==n?n:r?t.notAwailable:""},I=e=>{var{isEligibilityLoading:n,existingCurrentAssetLiceses:r}=e;return n?void 0:r||[]},w=e=>{var{asset:n,selectedLicenseId:r,activeFormatType:a,selectedShadowsOption:l}=e;return(0,t._)((0,i._)((0,t._)({},n),{itemType:n.itemType||(0,s.rw)({asset:n}),licenseId:r}),a===o._3&&{licenseAsJpeg:!0},(0,c.f8)(n)?{selectedFormatType:a,selectedShadowsOption:l}:{})}},7681:function(e,n,r){r.d(n,{Zo:function(){return eo}});var t=r(81862),i=r(57460),o=r(6692),a=r(9774),l=r(94346),u=r(97956),c=r(34904),s=r(22253),d=r(94095),v=r(68668),m=r(62463),p=r(38607),_=r(91145),f=r(33055),g=r(34944),h=r(14401),y=r(38409),b=r(46743),I=r(1880),w=r(72726),S=r(18271),C=r(2784),T=e=>{var n,{assets:r}=e,t=(0,w.Tp)(r[0]);return{include:"subscriptions",content_type:(0,m.JD)({assetType:t,assetId:null===(n=r[0])||void 0===n?void 0:n.id}),content_ids:r.reduce((e,n)=>[...e,n.id.toString()],[]).join(",")}},k=e=>{var{assets:n}=e,r={};return n.forEach(e=>{var n=(0,w.Tp)(e),t=(0,m.JD)({assetId:e.id,assetType:n});r[t]=[...r[t]?r[t]:[],e]}),r},N=e=>{var{assetEligibility:n}=e,{permittedLicenses:r,subscriptions:t}=n;return null==t?void 0:t.filter(e=>{var{license:n}=e;return r.includes(n.replace("_unlimited",""))})},A=e=>{var n,{assets:r=[],user:t}=e;return null===(n=Object.values(k({assets:r})))||void 0===n?void 0:n.map(e=>{var n=T({assets:e}),{formattedUrl:r}=(0,a.Td)({urlParams:{licenseeIdentifier:"organization-".concat(null==t?void 0:t.organizationId)},queryParams:n});return S.uS.get(r)})},E=e=>{var{data:n}=e,r=[];return n.map(e=>{var n=e.id.split("-"),t=n[n.length-1],i=N({assetEligibility:e});return r.push({assetId:t,subscriptions:i})}),r},j=r(63339),P=r(82124),D=r(68359),M=r(47614),O=r(20463),z=r(62130),R=()=>{var{analytics:e}=(0,j.yh)(),{getSearchContext:n}=(0,z.Y)(),r=n();return(0,C.useCallback)(n=>{var{assets:t=[]}=n;e.productLicensed({products:t.map(e=>(0,O.bR)({asset:e,shouldGetSearchContextFromAsset:!0})),search_context:r})},[e,r])},U=r(94001),q=r(88759),F=r(1369),x=r(54711),L=r(88809),J=r(68861),W=r(12139),$=r(66487),B=r(4918),H=r(59877),V=r(12249),K=r(8947),Z=r(82528),G=new RegExp(J.C),X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{emailCartCheckoutConfirmation:n,orderEmail:r}=e;return n&&r?r.split(",").filter(e=>G.test(e)):[]},Y=e=>{var{purchaseOrder:n}=e;return"".concat(null==n?void 0:n[0]," : ").concat(null==n?void 0:n[1]).split(" ").map(e=>(0,B.k)(e)).join(" ")},Q=e=>{var{t:n,keys:{currentYear:r,emailAddress:t,purchaseOrder:i}}=e;return{copyright:n("site-footer:copyright",{CURRENT_YEAR:r}),emailSentTo:n("ent:email_sent_to",{EMAIL_ADDRESS:t}),emailSubjectLine:"".concat(n("ent:order_confirmation_email_subject")," | ").concat(Y({purchaseOrder:i})),name:n("account:profile_name"),needAssistance:n("ent:contact_sales_representative"),orderConfirmation:n("ent:order_confirmation"),purchaseInformation:n("ent:purchase_information_key"),shutterstockAddress:n("tos:tos_2020_09_04_part_v_24_table_r2_c2_l2"),shutterstockInc:n("tos:tos_2020_09_04_part_v_24_table_r2_c2_l1"),subtotal:n("ent:order_confirmation_email_subtotal"),thisIsNotAnInvoice:n("ent:not_an_invoice")}},ee=()=>{var{t:e}=(0,H.$G)(x.jp5),{data:n}=(0,q.jy)(),{data:r}=(0,K.b)(),{data:t}=(0,V.B)(),{name:i,email:o,phone:a}=(0,Z.z)({fetchTrigger:!0})||{},{locale:l,fullLocale:u}=(0,v.PE)(),c=(0,U.o)();return{sendOrderConfirmationEmails:(0,C.useCallback)(function(){var{cartTotalCurrency:s,filteredOrderMetadata:d,licenseMetadata:v,priceType:m}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},p=[...(null==r?void 0:r.emailCartCheckoutConfirmation)?[null==n?void 0:n.email]:[],...X(t)];if(p.length&&(null==d?void 0:d.length)){var _,f,g,h,y=Q({t:e,keys:{currentYear:new Date().getFullYear(),emailAddress:null==n?void 0:n.email,purchaseOrder:Object.entries(v)[0],repName:i,repPhoneNumber:a,repEmail:o}});try{var b={cartItems:d,fullName:null==n?void 0:n.fullName,invoiceDate:new Intl.DateTimeFormat(u).format(new Date),labels:y,licenseMetadata:v,repEmail:o,repName:i,repPhoneNumber:a,totalAmount:c({price:(0,W.P1)(d,[]),localeCurrencyOverride:s,priceType:m}),username:null==n?void 0:n.username};$.IZ.post((0,L.K0)().formattedUrl,{emails:[...new Set(p)],emailBody:b,emailSubject:"".concat(y.emailSubjectLine),language:l})}catch(e){null===(f=window.NREUM)||void 0===f||null===(_=f.setTransactionName)||void 0===_||_.call(f,"sendOrderConfirmationEmail/".concat("noticeError")),null===(h=window.NREUM)||void 0===h||null===(g=h.noticeError)||void 0===g||g.call(h,e,{message:"Failed sending order confirmation emails to: ".concat(p.join(", "))})}}},[u,l,t,c,o,i,a,e,null==n?void 0:n.email,null==n?void 0:n.fullName,null==n?void 0:n.username,null==r?void 0:r.emailCartCheckoutConfirmation])}},en=r(17140),er={[s.dWU]:a.CE,[s.zM6]:a.s0},et=e=>{var n,r,{asset:t,subscriptions:i}=e,o=(0,m.qw)({asset:t}),{licenseId:a,contentTier:l}=t;switch(o){case u.pX:return(0,h.I)({assetType:u.pX,subscriptions:[...null!==(n=null==i?void 0:i.videoSubscriptions)&&void 0!==n?n:[],...null!==(r=null==i?void 0:i.videoCompSubscriptions)&&void 0!==r?r:[]],selectedLicenseId:a});case u.xF:case u.j0:return(0,y.$)({subscriptions:[...i.musicSubscriptions,...i.musicCompSubscriptions],licenseName:t.licenseId});case u.tn:return(0,y.$)({subscriptions:[...i.sfxSubscriptions,...i.sfxCompSubscriptions],licenseName:t.licenseId});case u.gP:return(0,y.$)({subscriptions:[...i.editorialImageSubscriptions,...i.editorialImageCompSubscriptions,...i.editorialVideoSubscriptions,...i.editorialVideoCompSubscriptions],licenseName:t.licenseId,contentTier:l});case u.k4:default:return(0,y.$)({subscriptions:[...i.imageSubscriptions,...i.imageCompSubscriptions],licenseName:t.licenseId,contentTier:l})}},ei=e=>{var{asset:n,subscriptions:r}=e,t=et({asset:n,subscriptions:r});return(0,b.q)({subscription:t})?(0,o._)((0,i._)({},t),{creditPrice:u.q9,creditType:d.Zm}):t},eo=()=>{var e,{isBrandEnterprise:n}=(0,I.D)(),{data:r}=(0,F.av)(),[a,d]=(0,C.useState)(!1),[y,b]=(0,C.useState)(""),[w,T]=(0,C.useState)({}),{data:k}=(0,q.jy)(),[,N]=(0,D.VM)(e=>e),O=(0,j.uA)()||(0,M.H7)(),z=R(),x=(0,U.o)(),L=(0,en.GB)(),{locale:J}=(0,v.PE)(),{sendOrderConfirmationEmails:W}=ee();return{isLicensing:a,licensingAssetsHandler:(0,C.useCallback)((e=(0,t._)(function*(e){var{alreadyLicensedAssets:a=[],assets:v=[],cartMetadata:y={},format:I="",licenseeMetadata:w={},isVideoComp:C=!1,licenseMetadata:j={},licensingType:D,selectedAssetSize:M=""}=e,R=(U=(0,t._)(function*(){var e,a=E({data:(yield Promise.all(A({assets:v,user:k}))).map(e=>{var{data:n}=e;return(0,P.O)(n)}).flat()}),l=v.map((e=(0,t._)(function*(e){var n=(0,m.qw)({asset:e}),{licenseId:r}=e,{subscriptions:t}=(null==a?void 0:a.find(n=>{var{assetId:r}=n;return r===String(e.id)}))||{},{id:l,license:s}=(0,h.I)({assetType:n,subscriptions:t,selectedLicenseId:r})||{},d=yield(0,p.Oo)({asset:e,format:I,selectedAssetSize:M,licenseName:s,isVideoComp:C});return(0,o._)((0,i._)({},d,M&&f.Bg[M]&&{comp_size:M},n===u.tn&&{override_filename:"".concat(c.Oq,"_").concat(e.id,".").concat(I||d.content_format)},n===u.w5&&{content_provider:u._R}),{license_name:s,show_modal:!0,subscription_id:l})}),function(n){return e.apply(this,arguments)}));return{licensingPayload:{content:yield Promise.all(l),license_metadata:j,required_cookies:"",decode_hadron_ids:n},orderMetadata:v.map(e=>{var{currency:n,description:t,descriptionLanguageMap:i={},id:o,itemType:a,headline:l,licenseId:u,preview:c={},price:s,priceType:d,src:v,thumb:m,thumbImageUrl:p,title:_,type:f}=e,g=n,h=s,y=d;if(!g||!h||!y){var{creditCurrency:b,creditPrice:I,creditType:w}=ei({asset:e,subscriptions:r});g=g||b,h=h||I,y=d||w}return g&&!q&&(q=g),y&&!F&&(F=y),{description:i[J]||t,formattedPrice:x({price:h,localeCurrencyOverride:g,priceType:y}),headline:l,id:o,itemType:a,licenseId:u,licenseName:L({licenseName:u}),price:h,priceType:y,thumbnailSrc:v||p||c.url||m,title:_,type:f}})}}),function(){return U.apply(this,arguments)});try{d(!0),b("");var U,q,F,$,B,{licensingPayload:H,orderMetadata:V}=yield R(),K=er[D]({urlParams:{licenseeIdentifier:"organization-".concat(null==k?void 0:k.organizationId)}}).formattedUrl,Z=yield S.uS.post(K,H,(0,g.S)({trackingId:O}));if(z({assets:v}),N({assets:v,metadata:y,licensedContent:(null===(B=(0,P.O)(Z.data))||void 0===B?void 0:null===($=B.meta)||void 0===$?void 0:$.licensedContent)||[]}),!v.some(e=>{var{licenseId:n}=e;return s.b53.includes(n)})){var G=V.filter(e=>!(0,_.te)({alreadyLicensedAssets:a,asset:e}));W({cartTotalCurrency:q,filteredOrderMetadata:G,licenseMetadata:w,priceType:F})}return b(l.MR),Z}catch(e){var X,Y,Q=(0,_.lW)({error:e,user:k});throw null===(Y=window.NREUM)||void 0===Y||null===(X=Y.addPageAction)||void 0===X||X.call(Y,"Enterprise licensing error",(0,o._)((0,i._)({},Q),{alreadyLicensedAssets:a,assets:v.map(e=>{var{id:n,type:r}=e;return{id:n,type:r}}),cartMetadata:y,format:I,licenseeMetadata:w,isVideoComp:C,licenseMetadata:j,licensingType:D,selectedAssetSize:M})),T(e),b(l.cM),e}finally{d(!1)}}),function(n){return e.apply(this,arguments)}),[k,n,J,x,L,r,O,z,N,W]),licensingError:w,licensingStatus:y,setIsLicensing:d,setLicensingStatus:b}}},12249:function(e,n,r){r.d(n,{B:function(){return v}});var t=r(57460),i=r(9774),o=r(22253),a=r(46447),l=r(34686),u=r(18271),c=r(82124),s=r(3255),d=r(88759),v=function(){var{queryParams:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{data:n}=(0,d.jy)(),r=(0,t._)({target:o.dlz,site_name:a.mC,setting_type:o.dlz},e);return(0,s.ZP)((null==n?void 0:n.id)&&(null==n?void 0:n.organizationId)&&(0,i.nI)({queryParams:r}).formattedUrl,e=>u.uS.get(e).then(e=>(0,c.O)(e.data)),{dedupingInterval:l.yR})}}}]);
//# sourceMappingURL=7681-3e26119e5989bfa2.js.map